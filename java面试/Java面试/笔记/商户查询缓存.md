# 缓存正常流程
![[1653322097736.png]]
# 缓存更新策略
## 内存淘汰
redis自动进行的，当Redis内存达到阈值时自动触发淘汰机制，淘汰掉一些不太重要的数据（可以自己设置策略方式）
## 超时剔除
给数据设计过期时间（TTL），超时的数据会自动删除
## 主动更新
手动调用方法把缓存删除，通常用于解决缓存和数据库不一致问题
## 总结
![[1653322506393.png]]

# 解决缓存不一致方案
由数据库的调用者，在更新数据库的同时，同步更新缓存。
## 选择删除还是更新缓存
选择删除，因为更新的话无效操作太多。

## 保证缓存的删除和数据库的操作一致性
单体系统，将删除和更新放到同一个事务当中
分布式系统，利用TCC等分布式事务方案

## 两个动作谁先谁后呢
应当先更新数据库，然后再删除缓存。
原因：
