一句话简单来说，索引的出现就是为了提高数据查询的效率，就像是书的目录一样。
# 索引的数据模型
## 哈希表
哈希表是基于拉链法来存储数据的。和HashMap的结构相同。
优点是查询速度很快，缺点是做区间查询很慢，因为没有顺序，因此必须做全表扫描。

## 有序数组
有序数组的等值查询和区间查询速度都很快。
但是缺点是更新数据的时候就麻烦了。
所以有序数组只适用于静态存储引擎，一般用于保存不再修改的数据。

## 搜索树
树可以有二叉树，也可以有多叉，从搜索效率上来讲，二叉树是最高的，但是实际上大多数数据库存储并不使用二叉树，这是因为索引不只是存在内存中，还存在于磁盘上。
访问磁盘上的数据会很慢，因此必须让查询过程中访问尽量少的数据块。
因此一般使用N叉树。

# InnoDB中的索引模型
InnoDB中，表都是根据主键顺序以索引的形式存放的，这种存储方式的表称为索引组织表。
每个索引在InnoDB中对应一棵B+树。

## 主键索引
主键索引叶子节点存的是整行数据。在InnoDB中，主键索引也被称为聚簇索引
非主键索引的叶子节点中存储的是主键的值，非主键索引也叫做二级索引。

两者的区别在于查询时二级索引需要查询两棵B+树，第二次查询的时候叫做回表。

## 索引维护
数据库中有数据页的概念。一个数据页是16KB。在插入数据的时候有可能导致页分裂。
删除数据时可能导致页合并。

讨论案例：
哪些场景下应该使用自增主键，哪些场景下不应该？

首先，自增主键的数据插入都是追加操作，不会触发叶子节点的分裂。

这里参考一下[[Mysql是怎么运行的]]

主键长度越小，普通索引的叶子节点越小，占用空间就越小；
因此从性能和空间考虑，自增主键一般是更合理的原则；
但是当只有一个索引，而且索引必须是唯一索引时，可以直接将这个索引设置成主键。
